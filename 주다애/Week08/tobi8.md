## 8. 스프링이란 무엇인가?

> 스프링은 자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크이다.

### 1. 스프링의 정의

> 스프링은 자바 엔터프라이즈 개발을 편하게 해주는 오픈소스 경량급 애플리케이션 프레임워크이다.

#### 애플리케이션 프레임워크
애플리케이션 프레임워크는 애플리케이션 전 영역을 포괄하는 범용적인 프레임워크를 뜻한다. 

애플리케이션 개발의 전 과정을 빠르고 편리하며 효율적으로 진행하는데 일차적으로 목표를 두는 프레임워크이다.
또한 일관된 프로그래밍 모델과 핵심 기술을 바탕으로 해서 각 분야의 특성에 맞는 필요를 채워주고 있기 때문에 애플리케이션 개발에 효과적이다.

#### 경량급
스프링은 경량급 프레임워크이다.

이는 코드가 단순하고 작다는 것이 아니라 **불필요하게 무겁지 않다**는 뜻이다.
* EJB는 WAS가 필요하고, 고가의 개발환경이 갖추어지지 않으면 개발이 불가능한 기술이었다.
* 그에 반해 스프링은 톰캣이나 제티에서도 완벽하게 동작하며 단순한 개발툴에서도 개발이 가능한 기술이다.
* 코드 또한 단순하고 가볍게 변했다.

결과적으로 스프링은 EJB를 대표로 하는 기존의 많은 기술이 불필요하게 무겁고 복잡했음을 증명하였다는 면에서 **경량급 프레임워크**라고 불리는 것이다. 

#### 자바 엔터프라이즈 개발을 편하게
스프링은 **근본적인 부분**에서 엔터프라이즈 개발의 복잡함을 제거하고 진정으로 개발을 편하게 해주는 해결책을 제시한다.

편리한 애플리케이션 개발은 개발자가 복잡하고 실수하기 쉬운 로우레벨 기술에 많은 신경을 쓰지 않으면서도 애플리케이션의 핵심인 사용자의 요구사항, 즉 비즈니스 로직을 빠르고 효과적이게 구현하는 것을 말한다.

#### 오픈소스
오픈소스란 소스가 모두에게 공개되고, 특별한 라이선스를 취득할 필요 없이 자유롭게 사용가능하다는 의미로, 스프링은 오픈소스 프로젝트 방식으로 개발되고 있다.

* 오픈소스는 자유롭게 참여할 수 있어 개발이 유연하고 빠르게 가능하다. 또한 피드백이 빠르게 작용되어 더 좋은 코드로의 발전이 가능하다.
* 하지만 지속성과 안정성에 대해서는 취약하다. 또한 개발자 개개인에게 극히 의존적인 단점이있다.

그래서 스프링은 스프링소스라는 전문 기업이 개발을 책임지며 오픈소스의 장점도 가져가고 있다.

### 2. 스프링의 목적

> 스프링의 목적은 경량급 프레임워크인 스프링을 활용해서 엔터프라이즈 애플리케이션 개발을 편하게 하는 것이다.

#### 1. 엔터프라이즈 개발의 복잡함
자바 엔터프라이즈 개발이 실패하는 이유는?

엔터프라이즈 개발이 복잡하기 때문이다.

#### 복잡함의 근본적 이유
1. 기술적인 제약조건과 요구사항 증가
엔터프라이즈 시스템이 기업 업무를 처리하는 데 핵심적인 역할로 등장하고 중요해지면서 점점 더 기술적인 요구는 심화되고 그에 따른 복잡도는 증가한다.

2. 엔터프라이즈 애플리케이션이 구현해야 할 핵심기능인 비즈니스 로직의 복잡함 증가
과거와 달리 현재는 엔터프라이즈 시스템에 대한 업무 의존도가 높다. 그리고 처리해야 하는 정보의 규모도 많아지고 있다.

#### 복잡함을 가중시키는 원인
비즈니스 로직의 복잡함과 기술적인 복잡함이 한데 얽혀 있기 때문에 복잡도가 증가한다.

#### 2. 복잡함을 해결하려는 도전
근본적인 복잡함의 원인은 제거가 현실적으로 불가능하다.
그래서 우리는 복잡함을 효과적으로 상대할 수 있는 전략과 기법이 필요하다.

먼저, 두 가지 복잡함의 원인을 분리하자

1. 실패한 해결책 : EJB
EJB는 복잡함 분리를 실패한 기술이다.
* 기술적인 복잡함을 핵심 로직에서 일부 분리는 성공했다.
* 하지만 그에 따라서  EJB라는 환경과 스펙에 종속되는 코드로 만들어져야 하는 더 큰 부담을 가지게 되었다.
* 가장 치명적인 것은 EJB라는 틀 안에서 자바 코드를 만들게 강제함으로써 **자바 언어가 가진 가장 큰 특징이자 장점인 객체지향적 특성을 잃게 되었다.** 

2. 비침투적인 방식을 통한 효과적인 해결책 : 스프링
스프링은 비침투적인 기술을 사용하여 기술적인 복잡함과 비즈니스 로직을 다루는 코드를 깔끔하게 분리하였다.

* 비침투적 방식 : 기술의 적용 사실이 코드에 직접 반영되지 않는 기술
* 스프링을 이용하면 두 가지 **복잡함을 분리하는 과정에서 스프링 스스로가 애플리케이션 코드에 불필요하게 나타나지 않는다.**

**결국, 스프링을 통해 근본적 복잡함을 없앤 것이 아니라 복잡함을 분리하여 효과적 개발을 가져온 것이다.**

#### 3. 복잡함을 상대하는 스프링의 전략
스프링의 기본적인 전략은 비즈니스 로직을 담은 애플리케이션 코드와 엔터프라이즈 기술을 처리하는 코드를 분리하는 것이다.

#### 1. 기술적 복잡함을 상대하는 전략
#### 첫 번째 문제 : 기술에 대한 접근 방식이 일관성이 없고, 특정 환경에 종속적이다.
스프링은 **서비스 추상화**를 통해 일관성 없는 기술과 서버환경의 변화에 대항한다.

* 기술적인 복잡함은 추상화를 통해 로우레벨의 기술 구현 부분과 기술을 사용하는 인터페이스를 분리하고, 환경과 세부기술에 독립적인 접근 인터페이스를 제공하는 것이 베스트
* 스프링이 제공하는 템플릿/콜백 패턴을 통해 중복과 반복을 제거하여 기술을 사용하는 코드도 최적화된 핵심 로직에만 집중하도록 도와준다. 

#### 두 번째문제 : 기술적인 처리를 담담하는 코드가 성격이 다른 코드에 섞여서 등장한다.
스프링은 **AOP**를 사용해서 기술과 비즈니스 로직의 혼재로 발생하는 복잠함을 해결한다.

* AOP는 최후까지 애플리케이션 로직을 담당하는 코드에 남아 있는 기술 관련 코드를 깔끔하게 분리해서 별도의 모듈로 관리하게 해주는 강력한 기술이다.

#### 2. 비즈니스와 애플리케이션 로직의 복잡함을 상대하는 전략
비즈니스 처리 로직은 대체로 복잡하다. 또한 자주 바뀌므로 대응 속도가 빨라야한다. 

예전에는 DB에 비즈니스 로직의 상당 부분을 집어 넣었는데, 데이터 엑세스를 중심으로 로직을 다루면 개발과 유지보수는 물론, 테스트도 매우 어렵다.
--> 그래서 최근에는 비즈니스 로직은 애플리케이션 안에서 처리하도록 한다.

#### 3. 핵심도구 : 객체지향과 DI
기술과 비즈니스 로직의 복잡함을 해결하는 데 스프링이 공통적으로 사용하는 도구는 바로 **객체지향**이다. 
* 스프링의 모토 = 기본으로 돌아가자 = 객체지향에 충실한 설계 및 개발을하자
* DI는 객체지향 설계 기술 없이는 그 존재의미가 없다. 즉, 객체지향적 설계를 하다보면 자연스럽게 적용되는 기법이다. 
* 결국 DI는 자연스럽게 객체지향적인 설계와 개발로 이끌어주는 좋은 동반자이다. 
* 비즈니스 로직 자체의 복잡함을 해결하려면 DI보다는 객체지향 설계 기법이 더 중요하다. 

결국, 모든 스프링의 기술과 전략은 객체지향이라는 자바 언어가 가진 강력한 도구를 극대화해서 사용할 수 있도록 돕는 것이다. 스프링은 거들 뿐!

### 3. POJO 프로그래밍

> 스프링의 정수는 엔터프라이즈 서비스 기능을  POJP에게 제공하는 것이다. 

#### 1. 스프링의 핵심 : POJO

![](https://velog.velcdn.com/images%2Fjsj3282%2Fpost%2Fb43f8824-c037-40ea-8df6-50891075a3e3%2Fimage.png)

스프링 애플리케이션 = POJO를 이용해 만든 코드 + POJO가 어떻게 관계를 맺고 동작하는지 정의해놓은 설계정보

#### 2. POJO란 무엇인가?
POJO는 **자바 오브젝트**를 이용해 애플리케이션의 **비즈니스 로직**을 구현하는 프로그래밍 방식이다.

#### 3. POJO의 조건

1. 특정 규약에 종속되지 않는다.
POJO는 자바 언어와 꼭 필요한 API 외에는 종속되지 않아야 한다. 
2. 특정 환경에 종속되지 않는다.
POJO는 환경에 독립적이어야 한다. 
3. POJO는 객체지향적인 자바 언어의 기본에 충실하게 만들어져야 한다.
단지 자바 언어를 사용해서 개발하는 것은 POJO 프로그래밍이 아니다.

결국 **진정한 POJO**란 **객체지향적 원리에 충실**하면서, **환경과 기술에 종속되지 않고** **필요에 따라 재활용**될 수 있는 방식으로 설계된 **오브젝트**이다.

#### 4. POJO의 장점
POJO의 장점은 POJO의 조건과 같다.
1. 특정한 기술과 환경에 종속되지 않는 오브젝트는 그만큼 깔끔한 코드가된다.
2. 환경의 제약에서 자유로우므로 자동화된 테스트에 매우 유리하다.
3. 객체지향적 설계를 자유롭게 적용 가능하다. 

#### 5. POJO 프레임워크
스프링은 POJO를 이용한 엔터프라이즈 애플리케이션 개발을 목적으로 하는 프레임워크이다. 

**POJO 프레임워크**란 POJO 프로그래밍이 가능하도록 기술적인 기반을 제공하는 프레임워크이다. 
![토비의 스프링 - 스프링이란 무엇인가?](https://gunju-ko.github.io//assets/img/posts/toby-spring/POJO%ED%94%84%EB%A0%88%EC%9E%84%EC%9B%8C%ED%81%AC.png)

스프링은 기술영역에만 관여하지 비즈니스 로직을 담당하는 POJO에서는 모습을 감춘다.

🎈 좋은 코드와 좋은 프레임워크의 특징은 그것을 사용해서 만들어지는 코드가 나쁜코드가 되기 어렵다는 점이다.

### 4. 스프링의 기술

> 스프링은 IoC/DI, AOP. PSA 라는 세 가지 가능기술(POJO 프로그래밍을 쉽게 할 수 있게하는)을 제공한다. 

여기서 중요한건, 스프링이 단순 기술을 제공하는 기술 프레임워크가 아니라는 것이다. 

스프링의 기술들은 스프링 프레임워크가 만들어진 진정한 목표인 POJO 기반의 엔터프라이즈 개발을 편리하게 해주는 도구일 뿐이다. 

#### 1. 제어의 역전(IoC) / 의존관계 주입(DI)
IoC/DI는 스프링의 가장 기본이 되는 기술이자 스프링의 핵심 개발 원칙이다. 

❔ 왜 두 개의 오브젝트를 분리해서 만들고, 인터페이스로 느슨하게 연결하고, 실제 사용할 대상은 DI를 통해 외부에서 지정하나?
✔ 유연한 확장이 가능하게 하기 위해서. OCP의 원칙을 지키기 위해서 

#### DI의 활용방법
#### 핵심 기능의 변경
의존 대상의 구현을 바꾸는 것이다. 전략 패턴 사용

#### 핵심기능의 동적인 변경
애플리케이션이 동작하는 중간에 의존 대상을 다이내믹하게 변경할 수 있다. 
다이내믹 라우팅 프록시나 프록시 오브젝트 기법 활용

#### 부가기능의 추가
핵심기능은 그대로 둔 채로 부가기능 추가. 데코레이터 패턴 사용

인터페이스를 두고 사용하게 하고, 실제 사용할 오브젝트는 외부에서 주입하는 DI방식을 적용하면 데코레이터 패턴을 쉽게 적용할 수 있다. (트랜잭션 기능 추가)

#### 인터페이스의 변경
어댑터 오브젝트를 만들어서 클라이언트가 사용하는 인터페이스와 실제 오브젝트 사이의 인터페이스가 일치하지 않는 경우 해결

PSA(서비스 추상화)는 클라이언트가 일관성 있게 사용할 수 있는 인터페이스를 정의해두고 DI를 통해 어댑터 역할을 하는 오브젝트를 이용하게 해준다.

#### 프록시
지연로딩, 원격 프록시 적용시 프록시 필요

#### 템플릿과 콜백
OCP의 원칙에 가장 들어맞는 패턴. 콜백을 템플릿에 주입해주는 방식은 DI에 가장 충실한 응용 방법이다.

#### 싱글톤과 오브젝트 스코프
DI는 DI할 오브젝트의 생명주기를 제어할 수 있기에 중요하다. 
* 싱글톤 : 가장 기본이 되는 스코프. 상태를 갖지 않도록 만든 오브젝트가 동시에 여러 스레드의 요청을 처리하는 방식 적용시 필요
* 위의 상황에서는 전통적인 싱글톤 패턴보단 컨테이너가 오브젝트를 관리하는 IoC방식이 유용
* 싱글톤이 아니고 임의의 생명주기를 갖는 오브젝트도 관리 가능

#### 테스트
테스트의 중요한 점은 고립이라는 부분.

의존 오브젝트를 대신해서 스텁/목 오브젝트 같은 테스트 대역을 사용해야하는데, 이 때 DI를 위해 만든 setter을 사용해서 테스트 메소드 안에서 수동으로 목 오브젝트 주입이 가능하다. 

#### 2. 애스펙트 지향 프로그래밍(AOP)
❗ AOP와 OOP는 배타적인 개념이 아니라 AOP가 객체지향 기술의 한계와 단점을 극복하도록 도와주는 보조적 프로그래밍 기술이다.
즉, AOP를 통해 OOP가 더욱 OOP다워진다. 

AOP를 가장 성공적으로 개발에 보급한 것이 스프링이다. 

#### AOP의 적용 기법
##### 첫 번째는 스프링과 같이 다이내믹 프록시 사용하는 방법
데코레이터 패턴 응용. 부가기능을 부여할 수 있는 곳은 메소드의 호출이 일어나는 지점뿐 이라는 제약은 존재
대부분이 이 방식

##### 두 번째는 자바 언어의 한계를 넘어서는 언어의 확장을 이용하는 방법
AspectJ라는 유명한 오픈소스 AOP 툴을 사용해서 AOP를 제공하는 방법
까다롭지만 프록시 방식의 AOP가 불가할 때 꼭 사용해야 한다.

#### AOP의 적용 단계
AOP는 객체지향적 개발 방법에서 출발했지만 그 성격이 자바의 일반적 개발 방법과는 상당히 다르므로 제대로 적용하기 위해 많은 시간과 노력이 필요하다. 
즉, 차근차근 AOP를 도입해보자

##### AOP 적용 1단계 : 미리 준비된 AOP 이용
일단 처음에는 스프링이 제공하는 AOP 기능을 그대로 가져다 적용하자.
트랜잭션이 가장 대표적이다. 
@Configuration 어노테이션을 통해서도 도메인 오브젝트에 DI를 자동 적용해준다.

##### AOP 적용 2단계 : 전담팀을 통한 정책 AOP 적용
좀 더 적극적으로 AOP를 적용하는 단계이다. 아직까지는 개발자 개개인에게 AOP 적용을 맡기지 말자.

대신, AOP를 책임지는 소수의 팀을 만들어서 적용하자. 

##### AOP 적용 3단계 : AOP의 자유로운 이용
두 단계를 거쳐 AOP와 친숙해지고 장단점과 응용전략, 위험성을 인지하게 되면 이제는 개발자 스스로가 AOP를 활용하자. 
세부적인 AOP를 개개인이 활용해서 개발이 가능하다.

#### 3. 포터블 서비스 추상화(PSA)
PSA는 환경과 세부 기술의 변화와 상관없이 일관된 방식으로 기술에 접근할 수 있게 해주는 기술이다. 

스프링은 JavaEE를 기본 플랫폼으로 하는 자바 엔터프라이즈 개발에 주로 사용되므로 다양한 JavaEE 기술에 의존적이게 된다.

❗ 특정 환경에 종속되지 않는다는 것이 그런 기술을 사용하지 않는다는 뜻이 아니다!
✔ POJO 코드가 그런 기술에 직접 노출되어 만들어지지 않는다는 말이다. 

이를 위해 스프링이 제공하는 대표적인 기술이 **일관성 있는 서비스 추상화**이다 . 스프링은 다양한 기술에 대한 서비스 추상화 기능을 제공한다.
* 트랜잭션 서비스 추상화는 코드를 이용해 트랜잭션을 제어하지 않는다면 직접 이용할 이유가 없다. 대신 설정에서 빈으로 등록해주면 된다.
* 직접 스프링이 제공하는 API를 사용해서 만드는 경우에는 스프링이 정의한 추상 API를 이용해 코드를 작성해라. 그리고 구체적 기술과 설정을 XML 파일 안에서 해주면 된다.

엔터프라이즈 개발에 사용되는 기술은 끊임없이 쏟아져 나온다. 그리고 보편적으로 사용되는 기술이라면 아마 다음 버전의 스프링에서 서비스 추상화 대상으로 포함시킬 가능성이 있다. 필요하면 직접 추상 레이어를 도입하고 일관성 있는  API를 정의해서 사용해라

✔ 서비스 추상화를 위해 필요한 기술은 DI 뿐이다. 

### 5. 정리
1. 스프링은 그 개발철학과 목표를 분명히 이해하고 사용해야 한다.
2. 스프링은 오픈소스 소프트웨어이며, 애플리케이션 개발의 모든 기술과 영역을 종합적으로 다루는 애플리케이션 프레임워크이다.
3. 엔터프라이즈 애플리케이션 개발의 복잡함은 비즈니스 로직과 엔터프라이즈 시스템의 기술적인 요구에 의해 발생한다. 기존의 접근 방법은 이 복잡도를 낮추지 못하여 자바의 객체지향적인 장점을 포기해야 한다는 문제점이 있다.
4. 자바의 근본인 객체지향적인 원리에 충실하게 개발할 수 있으며, 환경과 규약에 의존적이지 않은 POJO를 이용한 애플리케이션 개발은 엔터프라이즈 시스템 개발의 복잡함이 주는 많은 문제를 해결할 수 있다.
5. 스프링의 목적은 이런 POJO를 이용해 엔터프라이즈 애플리케이션을 쉽고 효과적으로 개발할 수 있도록 지원해주는 데 있다. 
6. POJO 방식의 개발을 돕기 위해 스프링은 IoC/DI, AOP. PSA와 같은 가능기술을 프레임워크와 컨테이너라는 방식을 통해 제공한다.
